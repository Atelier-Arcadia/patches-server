defmodule Patches.Vulnerability do
  @moduledoc """
  A description of a vulnerability that affects a software package.
  """

  defstruct(
    name: "",
    affected_platform: "",
    details_href: "",
    severity: 0,
    fixed_in: []
  )
end

defmodule Patches.Vulnerability.Severity do
  @moduledoc """
  Provides names for each severity level that a vulnerability can have.
  Each function returns a constant integer value that represents the severity
  level.
  """

  def unknown, do: 0
  def negligible, do: 1
  def low, do: 2
  def medium, do: 3
  def high, do: 4
  def urgent, do: 5
  def critical, do: 6
end

defmodule Patches.Vulnerability.Source do
  @moduledoc """
  A behaviour for modules capable of retrieving vulnerabilities for a platform,
  identified by a string.
  """

  @typedoc """
  Indicates successful retrieval of vulnerability information.

  The third `term` in the tuple should be the new state for the `Source`.
  """
  @type success :: {:ok, [Patches.Vulnerability], term}

  @typedoc """
  Indicates failure to retieve vulnerability information.
  """
  @type failure :: {:error, Atom.t}

  @doc """
  Retrieve more vulnerabilities given a configuration for the source state.
  """
  @callback retrieve(term) :: success | failure
end
